## PostgreSQL 9.3 Add API for 64-bit large object access  
                 
### 作者                 
digoal                  
                    
### 日期                  
2013-05-10                                           
                  
### 标签                                                                                                                                  
PostgreSQL , 64位大对象接口 , libpq    
                
----                  
                
## 背景     
```  
Increase the maximum length of large objects from 2GB to 4TB (Nozomi Anzai, Yugo Nagata)  
This change includes new libpq and server-side 64-bit-capable large object access functions.  
Add API for 64-bit large object access.  Now users can access up to  
4TB large objects (standard 8KB BLCKSZ case).  For this purpose new  
libpq API lo_lseek64, lo_tell64 and lo_truncate64 are added.  Also  
corresponding new backend functions lo_lseek64, lo_tell64 and  
lo_truncate64 are added. inv_api.c is changed to handle 64-bit  
offsets.  
  
Patch contributed by Nozomi Anzai (backend side) and Yugo Nagata  
(frontend side, docs, regression tests and example program). Reviewed  
by Kohei Kaigai. Committed by Tatsuo Ishii with minor editings.  
```  
  
PostgreSQL 9.3 新增了64位的大对象访问接口函数如下  
  
src/interfaces/libpq/fe-lobj.c  
  
lo_lseek64, lo_tell64 and lo_truncate64.  
  
同时新增了服务端64位函数.  
  
src/backend/libpq/be-fsstubs.c  
  
```  
digoal=# \df *.*lo_*  
                                 List of functions  
   Schema   |     Name      | Result data type |    Argument data types    |  Type    
------------+---------------+------------------+---------------------------+--------  
 pg_catalog | lo_close      | integer          | integer                   | normal  
 pg_catalog | lo_creat      | oid              | integer                   | normal  
 pg_catalog | lo_create     | oid              | oid                       | normal  
 pg_catalog | lo_export     | integer          | oid, text                 | normal  
 pg_catalog | lo_import     | oid              | text                      | normal  
 pg_catalog | lo_import     | oid              | text, oid                 | normal  
 pg_catalog | lo_lseek      | integer          | integer, integer, integer | normal  
 pg_catalog | lo_lseek64    | bigint           | integer, bigint, integer  | normal  
 pg_catalog | lo_open       | integer          | oid, integer              | normal  
 pg_catalog | lo_tell       | integer          | integer                   | normal  
 pg_catalog | lo_tell64     | bigint           | integer                   | normal  
 pg_catalog | lo_truncate   | integer          | integer, integer          | normal  
 pg_catalog | lo_truncate64 | integer          | integer, bigint           | normal  
 pg_catalog | lo_unlink     | integer          | oid                       | normal  
(14 rows)  
```  
  
大对象的服务端使用可参考 :   
  
http://blog.163.com/digoal@126/blog/static/16387704020130931040444/  
  
http://blog.163.com/digoal@126/blog/static/1638770402013264951552/  
  
## 参考  
1\. http://git.postgresql.org/gitweb/?p=postgresql.git;a=commit;h=461ef73f0977c95c9452680495bc161618db9227  
  
2\. http://blog.163.com/digoal@126/blog/static/16387704020130931040444/  
  
3\. http://blog.163.com/digoal@126/blog/static/1638770402013264951552/  
  
4\. 16 files changed:  
  
```  
doc/src/sgml/lobj.sgml		diff | blob | blame | history  
src/backend/libpq/be-fsstubs.c		diff | blob | blame | history  
src/backend/storage/large_object/inv_api.c		diff | blob | blame | history  
src/backend/utils/errcodes.txt		diff | blob | blame | history  
src/include/catalog/pg_proc.h		diff | blob | blame | history  
src/include/libpq/be-fsstubs.h		diff | blob | blame | history  
src/include/postgres_ext.h		diff | blob | blame | history  
src/include/storage/large_object.h		diff | blob | blame | history  
src/interfaces/libpq/exports.txt		diff | blob | blame | history  
src/interfaces/libpq/fe-lobj.c		diff | blob | blame | history  
src/interfaces/libpq/libpq-fe.h		diff | blob | blame | history  
src/interfaces/libpq/libpq-int.h		diff | blob | blame | history  
src/test/examples/Makefile		diff | blob | blame | history  
src/test/examples/testlo64.c	[new file with mode: 0644]	blob  
src/test/regress/input/largeobject.source		diff | blob | blame | history  
src/test/regress/output/largeobject.source		diff | blob | blame | history  
```  
  
5\. http://www.postgresql.org/docs/devel/static/lo-interfaces.html  
                                              
                                                                              
                                   
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
#### [9.9元购买3个月阿里云RDS PostgreSQL实例](https://www.aliyun.com/database/postgresqlactivity "57258f76c37864c6e6d23383d05714ea")
  
  
#### [PostgreSQL 解决方案集合](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [1 任意维度实时圈人](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [2 时序数据实时处理](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [3 时间、空间、业务 多维数据实时透视](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [4 独立事件相关性分析](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [5 海量关系实时图式搜索](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [6 社交业务案例](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [7 流式数据实时处理案例](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [8 IoT 物联网, 时序](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [9 全文检索](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [10 模糊、正则 查询案例](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [11 图像识别](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [12 向量相似检索](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [13 数据清洗、采样、脱敏、批处理、合并](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [14 GIS 地理信息空间数据应用](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [15 金融业务](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [16 异步消息应用案例](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [17 海量数据 冷热分离](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [18 倒排索引案例](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [19 海量数据OLAP处理应用](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
  
  
#### [德哥 / digoal's 趣味入口 - 努力成为灯塔, 公益是一辈子的事.](https://github.com/digoal/blog/blob/master/README.md "22709685feb7cab07d30f30387f0a9ae")
  
  
![德哥的微信 / digoal's wechat](../pic/digoal_weixin.jpg "f7ad92eeba24523fd47a6e1a0e691b59")
  
