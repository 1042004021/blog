## PostgreSQL 14 减少系统调用 - Use pg_pread() and pg_pwrite() for data files and WAL - Use pg_pread() and pg_pwrite() in slru.c   
  
### 作者  
digoal  
  
### 日期  
2020-08-03  
  
### 标签  
PostgreSQL , pg_pread , pg_pwrite , IO , 系统调用      
  
----  
  
## 背景  
  
https://git.postgresql.org/gitweb/?p=postgresql.git;a=commit;h=c24dcd0c  
  
```  
Use pg_pread() and pg_pwrite() for data files and WAL.  
author	Thomas Munro <tmunro@postgresql.org>	  
Wed, 7 Nov 2018 04:51:50 +0800 (09:51 +1300)  
committer	Thomas Munro <tmunro@postgresql.org>	  
Wed, 7 Nov 2018 04:51:50 +0800 (09:51 +1300)  
commit	c24dcd0cfd949bdf245814c4c2b3df828ee7db36  
tree	7b361229b1a9bb895894dff9eaa8a593be9e20ce	tree | snapshot  
parent	3fd2a7932ef0708dda57369bb20c0499d905cc82	commit | diff  
Use pg_pread() and pg_pwrite() for data files and WAL.  
  
Cut down on system calls by doing random I/O using offset-based OS  
routines where available.  Remove the code for tracking the 'virtual'  
seek position.  The only reason left to call FileSeek() was to get  
the file's size, so provide a new function FileSize() instead.  
  
Author: Oskari Saarenmaa, Thomas Munro  
Reviewed-by: Thomas Munro, Jesper Pedersen, Tom Lane, Alvaro Herrera  
Discussion: https://postgr.es/m/CAEepm=02rapCpPR3ZGF2vW=SBHSdFYO_bz_f-wwWJonmA3APgw@mail.gmail.com  
Discussion: https://postgr.es/m/b8748d39-0b19-0514-a1b9-4e5a28e6a208%40gmail.com  
Discussion: https://postgr.es/m/a86bd200-ebbe-d829-e3ca-0c4474b2fcb7%40ohmu.fi  
```  
  
https://git.postgresql.org/gitweb/?p=postgresql.git;a=commit;h=e2b37d9e7cabc90633c4bd822e1bcfdd1bda44c4  
  
```  
Use pg_pread() and pg_pwrite() in slru.c.  
author	Thomas Munro <tmunro@postgresql.org>	  
Sat, 1 Aug 2020 19:39:36 +0800 (23:39 +1200)  
committer	Thomas Munro <tmunro@postgresql.org>	  
Sat, 1 Aug 2020 20:23:35 +0800 (00:23 +1200)  
commit	e2b37d9e7cabc90633c4bd822e1bcfdd1bda44c4  
tree	f6cb217ead9b6e235c312ef2d4e2b53ec1716b9e	tree | snapshot  
parent	022350b8495a8a7ff0ff8dd6791572e91e7cd6fe	commit | diff  
Use pg_pread() and pg_pwrite() in slru.c.  
  
This avoids lseek() system calls at every SLRU I/O, as was  
done for relation files in commit c24dcd0c.  
  
Reviewed-by: Ashwin Agrawal <aagrawal@pivotal.io>  
Reviewed-by: Andres Freund <andres@anarazel.de>  
Discussion: https://postgr.es/m/CA%2BhUKG%2Biqke4uTRFj8D8uEUUgj%2BRokPSp%2BCWM6YYzaaamG9Wvg%40mail.gmail.com  
Discussion: https://postgr.es/m/CA%2BhUKGJ%2BoHhnvqjn3%3DHro7xu-YDR8FPr0FL6LF35kHRX%3D_bUzg%40mail.gmail.com  
```  
    
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
#### [免费领取阿里云RDS PostgreSQL实例、ECS虚拟机](https://www.aliyun.com/database/postgresqlactivity "57258f76c37864c6e6d23383d05714ea")
  
  
#### [大量阿里云PG解决方案: 任意维度实时圈人; 时序数据实时处理; 时间、空间、业务 多维数据实时透视; 独立事件相关性分析; 海量关系实时图式搜索; 社交业务案例; 流式数据实时处理案例; 物联网; 全文检索; 模糊、正则查询案例; 图像识别; 向量相似检索; 数据清洗、采样、脱敏、批处理、合并; GIS 地理信息空间数据应用; 金融业务; 异步消息应用案例; 海量数据 冷热分离; 倒排索引案例; 海量数据OLAP处理应用;](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
  
  
#### [德哥的 / digoal's PostgreSQL文章入口 - 努力做成PG资源最丰富的个人blog](https://github.com/digoal/blog/blob/master/README.md "22709685feb7cab07d30f30387f0a9ae")
  
  
![德哥的微信 / digoal's wechat](../pic/digoal_weixin.jpg "f7ad92eeba24523fd47a6e1a0e691b59")
  
