## 从一个数据类型/record/row中解析它对应的列名   
                                         
### 作者                        
digoal                        
                        
### 日期                         
2015-08-13                      
                          
### 标签                        
PostgreSQL , record , 复合类型 , 列名解析    
                                    
----                                    
                                     
## 背景                         
从一个数据类型/record/row中解析它对应的列名，这个在触发器中封装SQL是非常有用的。  
  
现在有这样的插件来帮助你完成这样的事情了。  
  
http://api.pgxn.org/src/colnames/colnames-1.5.0/doc/colnames.mmd  
  
```  
colnames 1.1.0  
==============  
  
Synopsis  
--------  
  
    CREATE EXTENSION colnames;  
  
    SELECT colnames( ROW(1, 'foo', 458.0) );  
      colnames    
    ------------  
     {f1,f2,f3}  
  
    SELECT colnames( ROW(c.*)::pg_collation ) FROM pg_collation c LIMIT 1;  
                                   colnames                                  
    -----------------------------------------------------------------------  
     {collname,collnamespace,collowner,collencoding,collcollate,collctype}  
  
Description  
-----------  
  
This extension contains a single SQL function, `colnames()`, that takes a  
record value as its argument and returns an array of the names of the columns  
in that record. This can be useful for example in trigger functions, where one  
might need to get the column names in order to generate a query string.  
  
Usage  
-----  
  
Simply pass a record value to the function and it will return an array of  
the column names for that record:  
  
    SELECT colnames( ROW(1, 'foo', 458.0) );  
      colnames    
    ------------  
     {f1,f2,f3}  
  
Note that this function is not strict; it's legal to pass in a null record of  
a named composite type:  
  
    SELECT colnames( NULL::pg_collation );  
                                   colnames                                  
    -----------------------------------------------------------------------  
     {collname,collnamespace,collowner,collencoding,collcollate,collctype}  
  
**Warning:** The indexes of the resulting array do **not** necessarily  
correspond to the values one might find when fetching column names from  
`pg_attribute.attnum`, since columns are not returned. The resulting array  
**does** correspond to the order of fields that would be returned by, say,  
`SELECT (rec).*`.  
  
Support  
-------  
  
This library is stored in an open [GitHub  
repository](http://github.com/theory/colnames). Feel free to fork and  
contribute! Please file bug reports via [GitHub  
Issues](http://github.com/theory/colnames/issues/).  
  
Author  
------  
  
[Andrew Gierth](http://blog.rhodiumtoad.org.uk/)  
[David E. Wheeler](http://www.justatheory.com/)  
  
Copyright and License  
---------------------  
  
Copyright (c) 2011 Andrew Gierth and David E. Wheeler.  
  
This module is free software; you can redistribute it and/or modify it under  
the [PostgreSQL License](http://www.opensource.org/licenses/postgresql).  
  
Permission to use, copy, modify, and distribute this software and its  
documentation for any purpose, without fee, and without a written agreement is  
hereby granted, provided that the above copyright notice and this paragraph  
and the following two paragraphs appear in all copies.  
  
In no event shall Andrew Gierth or David E. Wheeler be liable to any party for  
direct, indirect, special, incidental, or consequential damages, including  
lost profits, arising out of the use of this software and its documentation,  
even if Andrew Gierth or David E. Wheeler has been advised of the possibility  
of such damage.  
  
Andrew Gierth and David E. Wheeler specifically disclaim any warranties,  
including, but not limited to, the implied warranties of merchantability and  
fitness for a particular purpose. The software provided hereunder is on an "as  
is" basis, and Andrew Gierth and David E. Wheeler have no obligations to  
provide maintenance, support, updates, enhancements, or modifications.  
```  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
#### [免费领取阿里云RDS PostgreSQL实例、ECS虚拟机](https://www.aliyun.com/database/postgresqlactivity "57258f76c37864c6e6d23383d05714ea")
  
  
#### [大量阿里云PG解决方案: 任意维度实时圈人; 时序数据实时处理; 时间、空间、业务 多维数据实时透视; 独立事件相关性分析; 海量关系实时图式搜索; 社交业务案例; 流式数据实时处理案例; 物联网; 全文检索; 模糊、正则查询案例; 图像识别; 向量相似检索; 数据清洗、采样、脱敏、批处理、合并; GIS 地理信息空间数据应用; 金融业务; 异步消息应用案例; 海量数据 冷热分离; 倒排索引案例; 海量数据OLAP处理应用;](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
  
  
#### [德哥的 / digoal's PostgreSQL文章入口 - 努力做成PG资源最丰富的个人blog](https://github.com/digoal/blog/blob/master/README.md "22709685feb7cab07d30f30387f0a9ae")
  
  
![德哥的微信 / digoal's wechat](../pic/digoal_weixin.jpg "f7ad92eeba24523fd47a6e1a0e691b59")
  
