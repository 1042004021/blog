## PostgreSQL PRO 特性 - 内存表(in_memory) - 索引组织   
    
### 作者    
digoal    
    
### 日期    
2018-03-22    
    
### 标签    
PostgreSQL , postgrespro    
    
----    
    
## 背景    
postgrespro支持in-memory插件，实际上是位于内存中的索引组织表。  
  
https://postgrespro.com/docs/enterprise/11/in-memory  
  
目标场景：  
  
基于索引KEY值查询非常频繁的场景。  
  
原理：  
  
1、使用了索引组织存储。  
  
2、内存表使用固定PAGE大小，1KB。考虑到数据是索引组织一条记录不能跨页存储，所以行的最大长度为三分之一页大小，也就是304字节。  
  
3、不能使用toast特性。  
  
使用限制：  
    
1、最高隔离级别为repetable read模式  
  
2、不支持二级索引  
  
3、当tuple被删除时，不会修改in-memory表，所以数据还残留。不适合大量更新或删除。适合read only的情况。  
  
  
## in-memory插件相关参数和函数  
  
F.22.3. Reference  
  
F.22.3.1. Configuration Variables  
  
```  
in_memory.shared_pool_size (integer)  
  
Defines the size of the shared memory segment allocated for in-memory tables.  
  
Default: 8MB  
  
in_memory.undo_size (integer)  
  
Defines the size of the undo log.  
  
Default: 1MB  
```  
  
F.22.3.2. Functions  
  
```  
in_memory.in_memory_page_stats()  
Displays statistics on pages of in-memory tables:  
```  
  
used_pages — in-memory pages containing any data.  
  
free_pages — empty in-memory pages. This number includes all the initially allocated pages to which no data has been written yet, as well as the pages from which all data has been deleted.  
  
all_pages — the total number of in-memory pages allocated on this server.  
    
    
    
    
    
    
    
    
    
    
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
#### [9.9元购买3个月阿里云RDS PostgreSQL实例](https://www.aliyun.com/database/postgresqlactivity "57258f76c37864c6e6d23383d05714ea")
  
  
#### [PostgreSQL 解决方案集合](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [1 任意维度实时圈人](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [2 时序数据实时处理](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [3 时间、空间、业务 多维数据实时透视](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [4 独立事件相关性分析](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [5 海量关系实时图式搜索](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [6 社交业务案例](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [7 流式数据实时处理案例](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [8 IoT 物联网, 时序](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [9 全文检索](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [10 模糊、正则 查询案例](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [11 图像识别](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [12 向量相似检索](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [13 数据清洗、采样、脱敏、批处理、合并](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [14 GIS 地理信息空间数据应用](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [15 金融业务](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [16 异步消息应用案例](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [17 海量数据 冷热分离](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [18 倒排索引案例](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
- [19 海量数据OLAP处理应用](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
  
  
#### [德哥 / digoal's 趣味入口 - 努力成为灯塔, 公益是一辈子的事.](https://github.com/digoal/blog/blob/master/README.md "22709685feb7cab07d30f30387f0a9ae")
  
  
![德哥的微信 / digoal's wechat](../pic/digoal_weixin.jpg "f7ad92eeba24523fd47a6e1a0e691b59")
  
